<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AutoCaption Pro</title>
</head>
<body>
  <h1>AutoCaption Pro</h1>
  <p>Upload your video link, pay securely, and receive your transcript.</p>

  <!-- Simple form -->
  <form id="job-form">
    <label>Email:</label><br />
    <input type="email" id="email" required /><br /><br />

    <label>YouTube URL:</label><br />
    <input type="url" id="video-url" required /><br /><br />

    <label>Tier:</label><br />
    <select id="tier">
      <option value="1">Test Tier ($1.00)</option>
    </select>
  </form>

  <h2>Pay with PayPal</h2>
  <div id="paypal-button-container"></div>

  <!-- ✅ PayPal SDK (use your live Client ID) -->
  <script src="https://www.paypal.com/sdk/js?client-id=YOUR_LIVE_CLIENT_ID&currency=USD"></script>

  <script>
    paypal.Buttons({
      createOrder: function(data, actions) {
        const email = document.getElementById("email").value;
        const videoUrl = document.getElementById("video-url").value;

        // Store job session before payment (optional, can call your Worker here)

        return actions.order.create({
          purchase_units: [{
            amount: {
              value: "1.00"  // ✅ $1 test price
            }
          }]
        });
      },
      onApprove: function(data, actions) {
        return actions.order.capture().then(function(details) {
          console.log("✅ Payment completed by " + details.payer.name.given_name);
          alert("Payment successful! Order ID: " + data.orderID);

          // Optionally notify your Worker
          fetch("/paypal/notify", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              orderID: data.orderID,
              email: document.getElementById("email").value,
              video_url: document.getElementById("video-url").value,
              tier: document.getElementById("tier").value
            })
          });
        });
      }
    }).render("#paypal-button-container");
  </script>
</body>
</html>

